#include "myblas_internal.h"
#include <stdio.h>

void myblas_dgemm_kernel_detail(
         size_t M1, size_t N1, size_t K1,
         double alpha, const double *A2, const double *B2, 
         double *C, size_t ldc )
{
	double a00,a01,a02,a03;
	double a10,a11,a12,a13;
	double a20,a21,a22,a23;
	double a30,a31,a32,a33;

	double b00,b01,b02,b03;
	double b10,b11,b12,b13;
	double b20,b21,b22,b23;
	double b30,b31,b32,b33;

	double c00,c01,c02,c03;
	double c10,c11,c12,c13;
	double c20,c21,c22,c23;
	double c30,c31,c32,c33;

	// ---- Kernel
	size_t n = N1;
	if( n >> 2 ){
	  size_t n4 = ( n >> 2 );
	  while( n4-- ){
	    size_t m = M1;
	    if( m >> 2 ){
	      size_t m4 = ( m >> 2 );
	      while( m4-- ){

	        c00=0e0;c01=0e0;c02=0e0;c03=0e0;
	        c10=0e0;c11=0e0;c12=0e0;c13=0e0;
	        c20=0e0;c21=0e0;c22=0e0;c23=0e0;
	        c30=0e0;c31=0e0;c32=0e0;c33=0e0;
	        size_t k = K1;
	        if( k >> 3 ){
	          size_t k8 = ( k >> 3 );
	          while( k8-- ){
	            a00 = *(A2 + 0 + 0*4 ); a01 = *(A2 +  0 + 1*4 ); a02 = *(A2 + 0 + 2*4 ); a03 = *(A2 + 0 + 3*4 );
	            a10 = *(A2 + 1 + 0*4 ); a11 = *(A2 +  1 + 1*4 ); a12 = *(A2 + 1 + 2*4 ); a13 = *(A2 + 1 + 3*4 );
	            a20 = *(A2 + 2 + 0*4 ); a21 = *(A2 +  2 + 1*4 ); a22 = *(A2 + 2 + 2*4 ); a23 = *(A2 + 2 + 3*4 );
	            a30 = *(A2 + 3 + 0*4 ); a31 = *(A2 +  3 + 1*4 ); a32 = *(A2 + 3 + 2*4 ); a33 = *(A2 + 3 + 3*4 );
	            b00 = *(B2 + 0 + 0*4 ); b01 = *(B2 +  0 + 1*4 ); b02 = *(B2 + 0 + 2*4 ); b03 = *(B2 + 0 + 3*4 );
	            b10 = *(B2 + 1 + 0*4 ); b11 = *(B2 +  1 + 1*4 ); b12 = *(B2 + 1 + 2*4 ); b13 = *(B2 + 1 + 3*4 );
	            b20 = *(B2 + 2 + 0*4 ); b21 = *(B2 +  2 + 1*4 ); b22 = *(B2 + 2 + 2*4 ); b23 = *(B2 + 2 + 3*4 );
	            b30 = *(B2 + 3 + 0*4 ); b31 = *(B2 +  3 + 1*4 ); b32 = *(B2 + 3 + 2*4 ); b33 = *(B2 + 3 + 3*4 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c02 += a00 * b20; c02 += a01 * b21; c02 += a02 * b22; c02 += a03 * b23; 
	            c03 += a00 * b30; c03 += a01 * b31; c03 += a02 * b32; c03 += a03 * b33; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            c12 += a10 * b20; c12 += a11 * b21; c12 += a12 * b22; c12 += a13 * b23; 
	            c13 += a10 * b30; c13 += a11 * b31; c13 += a12 * b32; c13 += a13 * b33; 
	            c20 += a20 * b00; c20 += a21 * b01; c20 += a22 * b02; c20 += a23 * b03; 
	            c21 += a20 * b10; c21 += a21 * b11; c21 += a22 * b12; c21 += a23 * b13; 
	            c22 += a20 * b20; c22 += a21 * b21; c22 += a22 * b22; c22 += a23 * b23; 
	            c23 += a20 * b30; c23 += a21 * b31; c23 += a22 * b32; c23 += a23 * b33; 
	            c30 += a30 * b00; c30 += a31 * b01; c30 += a32 * b02; c30 += a33 * b03; 
	            c31 += a30 * b10; c31 += a31 * b11; c31 += a32 * b12; c31 += a33 * b13; 
	            c32 += a30 * b20; c32 += a31 * b21; c32 += a32 * b22; c32 += a33 * b23; 
	            c33 += a30 * b30; c33 += a31 * b31; c33 += a32 * b32; c33 += a33 * b33; 
	            a00 = *(A2 + 0 + 4*4 ); a01 = *(A2 +  0 + 5*4 ); a02 = *(A2 + 0 + 6*4 ); a03 = *(A2 + 0 + 7*4 );
	            a10 = *(A2 + 1 + 4*4 ); a11 = *(A2 +  1 + 5*4 ); a12 = *(A2 + 1 + 6*4 ); a13 = *(A2 + 1 + 7*4 );
	            a20 = *(A2 + 2 + 4*4 ); a21 = *(A2 +  2 + 5*4 ); a22 = *(A2 + 2 + 6*4 ); a23 = *(A2 + 2 + 7*4 );
	            a30 = *(A2 + 3 + 4*4 ); a31 = *(A2 +  3 + 5*4 ); a32 = *(A2 + 3 + 6*4 ); a33 = *(A2 + 3 + 7*4 );
	            b00 = *(B2 + 0 + 4*4 ); b01 = *(B2 +  0 + 5*4 ); b02 = *(B2 + 0 + 6*4 ); b03 = *(B2 + 0 + 7*4 );
	            b10 = *(B2 + 1 + 4*4 ); b11 = *(B2 +  1 + 5*4 ); b12 = *(B2 + 1 + 6*4 ); b13 = *(B2 + 1 + 7*4 );
	            b20 = *(B2 + 2 + 4*4 ); b21 = *(B2 +  2 + 5*4 ); b22 = *(B2 + 2 + 6*4 ); b23 = *(B2 + 2 + 7*4 );
	            b30 = *(B2 + 3 + 4*4 ); b31 = *(B2 +  3 + 5*4 ); b32 = *(B2 + 3 + 6*4 ); b33 = *(B2 + 3 + 7*4 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c02 += a00 * b20; c02 += a01 * b21; c02 += a02 * b22; c02 += a03 * b23; 
	            c03 += a00 * b30; c03 += a01 * b31; c03 += a02 * b32; c03 += a03 * b33; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            c12 += a10 * b20; c12 += a11 * b21; c12 += a12 * b22; c12 += a13 * b23; 
	            c13 += a10 * b30; c13 += a11 * b31; c13 += a12 * b32; c13 += a13 * b33; 
	            c20 += a20 * b00; c20 += a21 * b01; c20 += a22 * b02; c20 += a23 * b03; 
	            c21 += a20 * b10; c21 += a21 * b11; c21 += a22 * b12; c21 += a23 * b13; 
	            c22 += a20 * b20; c22 += a21 * b21; c22 += a22 * b22; c22 += a23 * b23; 
	            c23 += a20 * b30; c23 += a21 * b31; c23 += a22 * b32; c23 += a23 * b33; 
	            c30 += a30 * b00; c30 += a31 * b01; c30 += a32 * b02; c30 += a33 * b03; 
	            c31 += a30 * b10; c31 += a31 * b11; c31 += a32 * b12; c31 += a33 * b13; 
	            c32 += a30 * b20; c32 += a31 * b21; c32 += a32 * b22; c32 += a33 * b23; 
	            c33 += a30 * b30; c33 += a31 * b31; c33 += a32 * b32; c33 += a33 * b33; 
	            A2+=32;
	            B2+=32;
	          }
	        }
	        if( k & 4 ){
	            a00 = *(A2 + 0 + 0*4 ); a01 = *(A2 +  0 + 1*4 ); a02 = *(A2 + 0 + 2*4 ); a03 = *(A2 + 0 + 3*4 );
	            a10 = *(A2 + 1 + 0*4 ); a11 = *(A2 +  1 + 1*4 ); a12 = *(A2 + 1 + 2*4 ); a13 = *(A2 + 1 + 3*4 );
	            a20 = *(A2 + 2 + 0*4 ); a21 = *(A2 +  2 + 1*4 ); a22 = *(A2 + 2 + 2*4 ); a23 = *(A2 + 2 + 3*4 );
	            a30 = *(A2 + 3 + 0*4 ); a31 = *(A2 +  3 + 1*4 ); a32 = *(A2 + 3 + 2*4 ); a33 = *(A2 + 3 + 3*4 );
	            b00 = *(B2 + 0 + 0*4 ); b01 = *(B2 +  0 + 1*4 ); b02 = *(B2 + 0 + 2*4 ); b03 = *(B2 + 0 + 3*4 );
	            b10 = *(B2 + 1 + 0*4 ); b11 = *(B2 +  1 + 1*4 ); b12 = *(B2 + 1 + 2*4 ); b13 = *(B2 + 1 + 3*4 );
	            b20 = *(B2 + 2 + 0*4 ); b21 = *(B2 +  2 + 1*4 ); b22 = *(B2 + 2 + 2*4 ); b23 = *(B2 + 2 + 3*4 );
	            b30 = *(B2 + 3 + 0*4 ); b31 = *(B2 +  3 + 1*4 ); b32 = *(B2 + 3 + 2*4 ); b33 = *(B2 + 3 + 3*4 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c02 += a00 * b20; c02 += a01 * b21; c02 += a02 * b22; c02 += a03 * b23; 
	            c03 += a00 * b30; c03 += a01 * b31; c03 += a02 * b32; c03 += a03 * b33; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            c12 += a10 * b20; c12 += a11 * b21; c12 += a12 * b22; c12 += a13 * b23; 
	            c13 += a10 * b30; c13 += a11 * b31; c13 += a12 * b32; c13 += a13 * b33; 
	            c20 += a20 * b00; c20 += a21 * b01; c20 += a22 * b02; c20 += a23 * b03; 
	            c21 += a20 * b10; c21 += a21 * b11; c21 += a22 * b12; c21 += a23 * b13; 
	            c22 += a20 * b20; c22 += a21 * b21; c22 += a22 * b22; c22 += a23 * b23; 
	            c23 += a20 * b30; c23 += a21 * b31; c23 += a22 * b32; c23 += a23 * b33; 
	            c30 += a30 * b00; c30 += a31 * b01; c30 += a32 * b02; c30 += a33 * b03; 
	            c31 += a30 * b10; c31 += a31 * b11; c31 += a32 * b12; c31 += a33 * b13; 
	            c32 += a30 * b20; c32 += a31 * b21; c32 += a32 * b22; c32 += a33 * b23; 
	            c33 += a30 * b30; c33 += a31 * b31; c33 += a32 * b32; c33 += a33 * b33; 
	            A2+=16;
	            B2+=16;
	        }
	        if( k & 2 ){
	            a00 = *(A2 + 0 + 0*4 ); a01 = *(A2 +  0 + 1*4 );
	            a10 = *(A2 + 1 + 0*4 ); a11 = *(A2 +  1 + 1*4 );
	            a20 = *(A2 + 2 + 0*4 ); a21 = *(A2 +  2 + 1*4 );
	            a30 = *(A2 + 3 + 0*4 ); a31 = *(A2 +  3 + 1*4 );
	            b00 = *(B2 + 0 + 0*4 ); b01 = *(B2 +  0 + 1*4 );
	            b10 = *(B2 + 1 + 0*4 ); b11 = *(B2 +  1 + 1*4 );
	            b20 = *(B2 + 2 + 0*4 ); b21 = *(B2 +  2 + 1*4 );
	            b30 = *(B2 + 3 + 0*4 ); b31 = *(B2 +  3 + 1*4 );
	            c00 += a00 * b00; c00 += a01 * b01;
	            c01 += a00 * b10; c01 += a01 * b11;
	            c02 += a00 * b20; c02 += a01 * b21;
	            c03 += a00 * b30; c03 += a01 * b31;
	            c10 += a10 * b00; c10 += a11 * b01;
	            c11 += a10 * b10; c11 += a11 * b11;
	            c12 += a10 * b20; c12 += a11 * b21;
	            c13 += a10 * b30; c13 += a11 * b31;
	            c20 += a20 * b00; c20 += a21 * b01;
	            c21 += a20 * b10; c21 += a21 * b11;
	            c22 += a20 * b20; c22 += a21 * b21;
	            c23 += a20 * b30; c23 += a21 * b31;
	            c30 += a30 * b00; c30 += a31 * b01;
	            c31 += a30 * b10; c31 += a31 * b11;
	            c32 += a30 * b20; c32 += a31 * b21;
	            c33 += a30 * b30; c33 += a31 * b31;
	            A2+=8;
	            B2+=8;
	        }
	        if( k & 1 ){
	            a00 = *(A2 + 0 + 0*4 );
	            a10 = *(A2 + 1 + 0*4 );
	            a20 = *(A2 + 2 + 0*4 );
	            a30 = *(A2 + 3 + 0*4 );
	            b00 = *(B2 + 0 + 0*4 );
	            b10 = *(B2 + 1 + 0*4 );
	            b20 = *(B2 + 2 + 0*4 );
	            b30 = *(B2 + 3 + 0*4 );
	            c00 += a00 * b00;
	            c01 += a00 * b10;
	            c02 += a00 * b20;
	            c03 += a00 * b30;
	            c10 += a10 * b00;
	            c11 += a10 * b10;
	            c12 += a10 * b20;
	            c13 += a10 * b30;
	            c20 += a20 * b00;
	            c21 += a20 * b10;
	            c22 += a20 * b20;
	            c23 += a20 * b30;
	            c30 += a30 * b00;
	            c31 += a30 * b10;
	            c32 += a30 * b20;
	            c33 += a30 * b30;
	            A2+=4;
	            B2+=4;
	        }
	        *(C+0+0*ldc) += alpha*c00;
	        *(C+0+1*ldc) += alpha*c01;
	        *(C+0+2*ldc) += alpha*c02;
	        *(C+0+3*ldc) += alpha*c03;
	        *(C+1+0*ldc) += alpha*c10;
	        *(C+1+1*ldc) += alpha*c11;
	        *(C+1+2*ldc) += alpha*c12;
	        *(C+1+3*ldc) += alpha*c13;
	        *(C+2+0*ldc) += alpha*c20;
	        *(C+2+1*ldc) += alpha*c21;
	        *(C+2+2*ldc) += alpha*c22;
	        *(C+2+3*ldc) += alpha*c23;
	        *(C+3+0*ldc) += alpha*c30;
	        *(C+3+1*ldc) += alpha*c31;
	        *(C+3+2*ldc) += alpha*c32;
	        *(C+3+3*ldc) += alpha*c33;
	        B2 = B2 - 4*K1;//N*K1
	        C+=4;
	      }

	    }
	    if( m & 2 ){

	        c00=0e0;c01=0e0;c02=0e0;c03=0e0;
	        c10=0e0;c11=0e0;c12=0e0;c13=0e0;
	        c20=0e0;c21=0e0;c22=0e0;c23=0e0;
	        c30=0e0;c31=0e0;c32=0e0;c33=0e0;
	        size_t k = K1;
	        if( k >> 3 ){
	          size_t k8 = ( k >> 3 );
	          while( k8-- ){
	            a00 = *(A2 + 0 + 0*2 ); a01 = *(A2 +  0 + 1*2 ); a02 = *(A2 + 0 + 2*2 ); a03 = *(A2 + 0 + 3*2 );
	            a10 = *(A2 + 1 + 0*2 ); a11 = *(A2 +  1 + 1*2 ); a12 = *(A2 + 1 + 2*2 ); a13 = *(A2 + 1 + 3*2 );
	            b00 = *(B2 + 0 + 0*4 ); b01 = *(B2 +  0 + 1*4 ); b02 = *(B2 + 0 + 2*4 ); b03 = *(B2 + 0 + 3*4 );
	            b10 = *(B2 + 1 + 0*4 ); b11 = *(B2 +  1 + 1*4 ); b12 = *(B2 + 1 + 2*4 ); b13 = *(B2 + 1 + 3*4 );
	            b20 = *(B2 + 2 + 0*4 ); b21 = *(B2 +  2 + 1*4 ); b22 = *(B2 + 2 + 2*4 ); b23 = *(B2 + 2 + 3*4 );
	            b30 = *(B2 + 3 + 0*4 ); b31 = *(B2 +  3 + 1*4 ); b32 = *(B2 + 3 + 2*4 ); b33 = *(B2 + 3 + 3*4 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c02 += a00 * b20; c02 += a01 * b21; c02 += a02 * b22; c02 += a03 * b23; 
	            c03 += a00 * b30; c03 += a01 * b31; c03 += a02 * b32; c03 += a03 * b33; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            c12 += a10 * b20; c12 += a11 * b21; c12 += a12 * b22; c12 += a13 * b23; 
	            c13 += a10 * b30; c13 += a11 * b31; c13 += a12 * b32; c13 += a13 * b33; 
	            a00 = *(A2 + 0 + 4*2 ); a01 = *(A2 +  0 + 5*2 ); a02 = *(A2 + 0 + 6*2 ); a03 = *(A2 + 0 + 7*2 );
	            a10 = *(A2 + 1 + 4*2 ); a11 = *(A2 +  1 + 5*2 ); a12 = *(A2 + 1 + 6*2 ); a13 = *(A2 + 1 + 7*2 );
	            b00 = *(B2 + 0 + 4*4 ); b01 = *(B2 +  0 + 5*4 ); b02 = *(B2 + 0 + 6*4 ); b03 = *(B2 + 0 + 7*4 );
	            b10 = *(B2 + 1 + 4*4 ); b11 = *(B2 +  1 + 5*4 ); b12 = *(B2 + 1 + 6*4 ); b13 = *(B2 + 1 + 7*4 );
	            b20 = *(B2 + 2 + 4*4 ); b21 = *(B2 +  2 + 5*4 ); b22 = *(B2 + 2 + 6*4 ); b23 = *(B2 + 2 + 7*4 );
	            b30 = *(B2 + 3 + 4*4 ); b31 = *(B2 +  3 + 5*4 ); b32 = *(B2 + 3 + 6*4 ); b33 = *(B2 + 3 + 7*4 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c02 += a00 * b20; c02 += a01 * b21; c02 += a02 * b22; c02 += a03 * b23; 
	            c03 += a00 * b30; c03 += a01 * b31; c03 += a02 * b32; c03 += a03 * b33; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            c12 += a10 * b20; c12 += a11 * b21; c12 += a12 * b22; c12 += a13 * b23; 
	            c13 += a10 * b30; c13 += a11 * b31; c13 += a12 * b32; c13 += a13 * b33; 
	            A2+=16;
	            B2+=32;
	          }
	        }
	        if( k & 4 ){
	            a00 = *(A2 + 0 + 0*2 ); a01 = *(A2 +  0 + 1*2 ); a02 = *(A2 + 0 + 2*2 ); a03 = *(A2 + 0 + 3*2 );
	            a10 = *(A2 + 1 + 0*2 ); a11 = *(A2 +  1 + 1*2 ); a12 = *(A2 + 1 + 2*2 ); a13 = *(A2 + 1 + 3*2 );
	            b00 = *(B2 + 0 + 0*4 ); b01 = *(B2 +  0 + 1*4 ); b02 = *(B2 + 0 + 2*4 ); b03 = *(B2 + 0 + 3*4 );
	            b10 = *(B2 + 1 + 0*4 ); b11 = *(B2 +  1 + 1*4 ); b12 = *(B2 + 1 + 2*4 ); b13 = *(B2 + 1 + 3*4 );
	            b20 = *(B2 + 2 + 0*4 ); b21 = *(B2 +  2 + 1*4 ); b22 = *(B2 + 2 + 2*4 ); b23 = *(B2 + 2 + 3*4 );
	            b30 = *(B2 + 3 + 0*4 ); b31 = *(B2 +  3 + 1*4 ); b32 = *(B2 + 3 + 2*4 ); b33 = *(B2 + 3 + 3*4 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c02 += a00 * b20; c02 += a01 * b21; c02 += a02 * b22; c02 += a03 * b23; 
	            c03 += a00 * b30; c03 += a01 * b31; c03 += a02 * b32; c03 += a03 * b33; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            c12 += a10 * b20; c12 += a11 * b21; c12 += a12 * b22; c12 += a13 * b23; 
	            c13 += a10 * b30; c13 += a11 * b31; c13 += a12 * b32; c13 += a13 * b33; 
	            A2+=8;
	            B2+=16;
	        }
	        if( k & 2 ){
	            a00 = *(A2 + 0 + 0*2 ); a01 = *(A2 +  0 + 1*2 );
	            a10 = *(A2 + 1 + 0*2 ); a11 = *(A2 +  1 + 1*2 );
	            b00 = *(B2 + 0 + 0*4 ); b01 = *(B2 +  0 + 1*4 );
	            b10 = *(B2 + 1 + 0*4 ); b11 = *(B2 +  1 + 1*4 );
	            b20 = *(B2 + 2 + 0*4 ); b21 = *(B2 +  2 + 1*4 );
	            b30 = *(B2 + 3 + 0*4 ); b31 = *(B2 +  3 + 1*4 );
	            c00 += a00 * b00; c00 += a01 * b01;
	            c01 += a00 * b10; c01 += a01 * b11;
	            c02 += a00 * b20; c02 += a01 * b21;
	            c03 += a00 * b30; c03 += a01 * b31;
	            c10 += a10 * b00; c10 += a11 * b01;
	            c11 += a10 * b10; c11 += a11 * b11;
	            c12 += a10 * b20; c12 += a11 * b21;
	            c13 += a10 * b30; c13 += a11 * b31;
	            A2+=4;
	            B2+=8;
	        }
	        if( k & 1 ){
	            a00 = *(A2 + 0 + 0*2 );
	            a10 = *(A2 + 1 + 0*2 );
	            b00 = *(B2 + 0 + 0*4 );
	            b10 = *(B2 + 1 + 0*4 );
	            b20 = *(B2 + 2 + 0*4 );
	            b30 = *(B2 + 3 + 0*4 );
	            c00 += a00 * b00;
	            c01 += a00 * b10;
	            c02 += a00 * b20;
	            c03 += a00 * b30;
	            c10 += a10 * b00;
	            c11 += a10 * b10;
	            c12 += a10 * b20;
	            c13 += a10 * b30;
	            A2+=2;
	            B2+=4;
	        }
	        *(C+0+0*ldc) += alpha*c00;
	        *(C+0+1*ldc) += alpha*c01;
	        *(C+0+2*ldc) += alpha*c02;
	        *(C+0+3*ldc) += alpha*c03;
	        *(C+1+0*ldc) += alpha*c10;
	        *(C+1+1*ldc) += alpha*c11;
	        *(C+1+2*ldc) += alpha*c12;
	        *(C+1+3*ldc) += alpha*c13;
	        B2 = B2 - 4*K1;//N*K1
	        C+=2;

	    }
	    if( m & 1 ){

	        c00=0e0;c01=0e0;c02=0e0;c03=0e0;
	        c10=0e0;c11=0e0;c12=0e0;c13=0e0;
	        c20=0e0;c21=0e0;c22=0e0;c23=0e0;
	        c30=0e0;c31=0e0;c32=0e0;c33=0e0;
	        size_t k = K1;
	        if( k >> 3 ){
	          size_t k8 = ( k >> 3 );
	          while( k8-- ){
	            a00 = *(A2 + 0 + 0*1 ); a01 = *(A2 +  0 + 1*1 ); a02 = *(A2 + 0 + 2*1 ); a03 = *(A2 + 0 + 3*1 );
	            b00 = *(B2 + 0 + 0*4 ); b01 = *(B2 +  0 + 1*4 ); b02 = *(B2 + 0 + 2*4 ); b03 = *(B2 + 0 + 3*4 );
	            b10 = *(B2 + 1 + 0*4 ); b11 = *(B2 +  1 + 1*4 ); b12 = *(B2 + 1 + 2*4 ); b13 = *(B2 + 1 + 3*4 );
	            b20 = *(B2 + 2 + 0*4 ); b21 = *(B2 +  2 + 1*4 ); b22 = *(B2 + 2 + 2*4 ); b23 = *(B2 + 2 + 3*4 );
	            b30 = *(B2 + 3 + 0*4 ); b31 = *(B2 +  3 + 1*4 ); b32 = *(B2 + 3 + 2*4 ); b33 = *(B2 + 3 + 3*4 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c02 += a00 * b20; c02 += a01 * b21; c02 += a02 * b22; c02 += a03 * b23; 
	            c03 += a00 * b30; c03 += a01 * b31; c03 += a02 * b32; c03 += a03 * b33; 
	            a00 = *(A2 + 0 + 4*1 ); a01 = *(A2 +  0 + 5*1 ); a02 = *(A2 + 0 + 6*1 ); a03 = *(A2 + 0 + 7*1 );
	            b00 = *(B2 + 0 + 4*4 ); b01 = *(B2 +  0 + 5*4 ); b02 = *(B2 + 0 + 6*4 ); b03 = *(B2 + 0 + 7*4 );
	            b10 = *(B2 + 1 + 4*4 ); b11 = *(B2 +  1 + 5*4 ); b12 = *(B2 + 1 + 6*4 ); b13 = *(B2 + 1 + 7*4 );
	            b20 = *(B2 + 2 + 4*4 ); b21 = *(B2 +  2 + 5*4 ); b22 = *(B2 + 2 + 6*4 ); b23 = *(B2 + 2 + 7*4 );
	            b30 = *(B2 + 3 + 4*4 ); b31 = *(B2 +  3 + 5*4 ); b32 = *(B2 + 3 + 6*4 ); b33 = *(B2 + 3 + 7*4 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c02 += a00 * b20; c02 += a01 * b21; c02 += a02 * b22; c02 += a03 * b23; 
	            c03 += a00 * b30; c03 += a01 * b31; c03 += a02 * b32; c03 += a03 * b33; 
	            A2+=8;
	            B2+=32;
	          }
	        }
	        if( k & 4 ){
	            a00 = *(A2 + 0 + 0*1 ); a01 = *(A2 +  0 + 1*1 ); a02 = *(A2 + 0 + 2*1 ); a03 = *(A2 + 0 + 3*1 );
	            b00 = *(B2 + 0 + 0*4 ); b01 = *(B2 +  0 + 1*4 ); b02 = *(B2 + 0 + 2*4 ); b03 = *(B2 + 0 + 3*4 );
	            b10 = *(B2 + 1 + 0*4 ); b11 = *(B2 +  1 + 1*4 ); b12 = *(B2 + 1 + 2*4 ); b13 = *(B2 + 1 + 3*4 );
	            b20 = *(B2 + 2 + 0*4 ); b21 = *(B2 +  2 + 1*4 ); b22 = *(B2 + 2 + 2*4 ); b23 = *(B2 + 2 + 3*4 );
	            b30 = *(B2 + 3 + 0*4 ); b31 = *(B2 +  3 + 1*4 ); b32 = *(B2 + 3 + 2*4 ); b33 = *(B2 + 3 + 3*4 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c02 += a00 * b20; c02 += a01 * b21; c02 += a02 * b22; c02 += a03 * b23; 
	            c03 += a00 * b30; c03 += a01 * b31; c03 += a02 * b32; c03 += a03 * b33; 
	            A2+=4;
	            B2+=16;
	        }
	        if( k & 2 ){
	            a00 = *(A2 + 0 + 0*1 ); a01 = *(A2 +  0 + 1*1 );
	            b00 = *(B2 + 0 + 0*4 ); b01 = *(B2 +  0 + 1*4 );
	            b10 = *(B2 + 1 + 0*4 ); b11 = *(B2 +  1 + 1*4 );
	            b20 = *(B2 + 2 + 0*4 ); b21 = *(B2 +  2 + 1*4 );
	            b30 = *(B2 + 3 + 0*4 ); b31 = *(B2 +  3 + 1*4 );
	            c00 += a00 * b00; c00 += a01 * b01;
	            c01 += a00 * b10; c01 += a01 * b11;
	            c02 += a00 * b20; c02 += a01 * b21;
	            c03 += a00 * b30; c03 += a01 * b31;
	            A2+=2;
	            B2+=8;
	        }
	        if( k & 1 ){
	            a00 = *(A2 + 0 + 0*1 );
	            b00 = *(B2 + 0 + 0*4 );
	            b10 = *(B2 + 1 + 0*4 );
	            b20 = *(B2 + 2 + 0*4 );
	            b30 = *(B2 + 3 + 0*4 );
	            c00 += a00 * b00;
	            c01 += a00 * b10;
	            c02 += a00 * b20;
	            c03 += a00 * b30;
	            A2+=1;
	            B2+=4;
	        }
	        *(C+0+0*ldc) += alpha*c00;
	        *(C+0+1*ldc) += alpha*c01;
	        *(C+0+2*ldc) += alpha*c02;
	        *(C+0+3*ldc) += alpha*c03;
	        B2 = B2 - 4*K1;//N*K1
	        C+=1;

	    }
	    A2 = A2 - M1*K1;
	    B2 = B2 + 4*K1;
	    C  = C - M1 + 4*ldc;
	  }
	}
	if( n & 2 ){

	    size_t m = M1;
	    if( m >> 2 ){
	      size_t m4 = ( m >> 2 );
	      while( m4-- ){

	        c00=0e0;c01=0e0;c02=0e0;c03=0e0;
	        c10=0e0;c11=0e0;c12=0e0;c13=0e0;
	        c20=0e0;c21=0e0;c22=0e0;c23=0e0;
	        c30=0e0;c31=0e0;c32=0e0;c33=0e0;
	        size_t k = K1;
	        if( k >> 3 ){
	          size_t k8 = ( k >> 3 );
	          while( k8-- ){
	            a00 = *(A2 + 0 + 0*4 ); a01 = *(A2 +  0 + 1*4 ); a02 = *(A2 + 0 + 2*4 ); a03 = *(A2 + 0 + 3*4 );
	            a10 = *(A2 + 1 + 0*4 ); a11 = *(A2 +  1 + 1*4 ); a12 = *(A2 + 1 + 2*4 ); a13 = *(A2 + 1 + 3*4 );
	            a20 = *(A2 + 2 + 0*4 ); a21 = *(A2 +  2 + 1*4 ); a22 = *(A2 + 2 + 2*4 ); a23 = *(A2 + 2 + 3*4 );
	            a30 = *(A2 + 3 + 0*4 ); a31 = *(A2 +  3 + 1*4 ); a32 = *(A2 + 3 + 2*4 ); a33 = *(A2 + 3 + 3*4 );
	            b00 = *(B2 + 0 + 0*2 ); b01 = *(B2 +  0 + 1*2 ); b02 = *(B2 + 0 + 2*2 ); b03 = *(B2 + 0 + 3*2 );
	            b10 = *(B2 + 1 + 0*2 ); b11 = *(B2 +  1 + 1*2 ); b12 = *(B2 + 1 + 2*2 ); b13 = *(B2 + 1 + 3*2 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            c20 += a20 * b00; c20 += a21 * b01; c20 += a22 * b02; c20 += a23 * b03; 
	            c21 += a20 * b10; c21 += a21 * b11; c21 += a22 * b12; c21 += a23 * b13; 
	            c30 += a30 * b00; c30 += a31 * b01; c30 += a32 * b02; c30 += a33 * b03; 
	            c31 += a30 * b10; c31 += a31 * b11; c31 += a32 * b12; c31 += a33 * b13; 
	            a00 = *(A2 + 0 + 4*4 ); a01 = *(A2 +  0 + 5*4 ); a02 = *(A2 + 0 + 6*4 ); a03 = *(A2 + 0 + 7*4 );
	            a10 = *(A2 + 1 + 4*4 ); a11 = *(A2 +  1 + 5*4 ); a12 = *(A2 + 1 + 6*4 ); a13 = *(A2 + 1 + 7*4 );
	            a20 = *(A2 + 2 + 4*4 ); a21 = *(A2 +  2 + 5*4 ); a22 = *(A2 + 2 + 6*4 ); a23 = *(A2 + 2 + 7*4 );
	            a30 = *(A2 + 3 + 4*4 ); a31 = *(A2 +  3 + 5*4 ); a32 = *(A2 + 3 + 6*4 ); a33 = *(A2 + 3 + 7*4 );
	            b00 = *(B2 + 0 + 4*2 ); b01 = *(B2 +  0 + 5*2 ); b02 = *(B2 + 0 + 6*2 ); b03 = *(B2 + 0 + 7*2 );
	            b10 = *(B2 + 1 + 4*2 ); b11 = *(B2 +  1 + 5*2 ); b12 = *(B2 + 1 + 6*2 ); b13 = *(B2 + 1 + 7*2 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            c20 += a20 * b00; c20 += a21 * b01; c20 += a22 * b02; c20 += a23 * b03; 
	            c21 += a20 * b10; c21 += a21 * b11; c21 += a22 * b12; c21 += a23 * b13; 
	            c30 += a30 * b00; c30 += a31 * b01; c30 += a32 * b02; c30 += a33 * b03; 
	            c31 += a30 * b10; c31 += a31 * b11; c31 += a32 * b12; c31 += a33 * b13; 
	            A2+=32;
	            B2+=16;
	          }
	        }
	        if( k & 4 ){
	            a00 = *(A2 + 0 + 0*4 ); a01 = *(A2 +  0 + 1*4 ); a02 = *(A2 + 0 + 2*4 ); a03 = *(A2 + 0 + 3*4 );
	            a10 = *(A2 + 1 + 0*4 ); a11 = *(A2 +  1 + 1*4 ); a12 = *(A2 + 1 + 2*4 ); a13 = *(A2 + 1 + 3*4 );
	            a20 = *(A2 + 2 + 0*4 ); a21 = *(A2 +  2 + 1*4 ); a22 = *(A2 + 2 + 2*4 ); a23 = *(A2 + 2 + 3*4 );
	            a30 = *(A2 + 3 + 0*4 ); a31 = *(A2 +  3 + 1*4 ); a32 = *(A2 + 3 + 2*4 ); a33 = *(A2 + 3 + 3*4 );
	            b00 = *(B2 + 0 + 0*2 ); b01 = *(B2 +  0 + 1*2 ); b02 = *(B2 + 0 + 2*2 ); b03 = *(B2 + 0 + 3*2 );
	            b10 = *(B2 + 1 + 0*2 ); b11 = *(B2 +  1 + 1*2 ); b12 = *(B2 + 1 + 2*2 ); b13 = *(B2 + 1 + 3*2 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            c20 += a20 * b00; c20 += a21 * b01; c20 += a22 * b02; c20 += a23 * b03; 
	            c21 += a20 * b10; c21 += a21 * b11; c21 += a22 * b12; c21 += a23 * b13; 
	            c30 += a30 * b00; c30 += a31 * b01; c30 += a32 * b02; c30 += a33 * b03; 
	            c31 += a30 * b10; c31 += a31 * b11; c31 += a32 * b12; c31 += a33 * b13; 
	            A2+=16;
	            B2+=8;
	        }
	        if( k & 2 ){
	            a00 = *(A2 + 0 + 0*4 ); a01 = *(A2 +  0 + 1*4 );
	            a10 = *(A2 + 1 + 0*4 ); a11 = *(A2 +  1 + 1*4 );
	            a20 = *(A2 + 2 + 0*4 ); a21 = *(A2 +  2 + 1*4 );
	            a30 = *(A2 + 3 + 0*4 ); a31 = *(A2 +  3 + 1*4 );
	            b00 = *(B2 + 0 + 0*2 ); b01 = *(B2 +  0 + 1*2 );
	            b10 = *(B2 + 1 + 0*2 ); b11 = *(B2 +  1 + 1*2 );
	            c00 += a00 * b00; c00 += a01 * b01;
	            c01 += a00 * b10; c01 += a01 * b11;
	            c10 += a10 * b00; c10 += a11 * b01;
	            c11 += a10 * b10; c11 += a11 * b11;
	            c20 += a20 * b00; c20 += a21 * b01;
	            c21 += a20 * b10; c21 += a21 * b11;
	            c30 += a30 * b00; c30 += a31 * b01;
	            c31 += a30 * b10; c31 += a31 * b11;
	            A2+=8;
	            B2+=4;
	        }
	        if( k & 1 ){
	            a00 = *(A2 + 0 + 0*4 );
	            a10 = *(A2 + 1 + 0*4 );
	            a20 = *(A2 + 2 + 0*4 );
	            a30 = *(A2 + 3 + 0*4 );
	            b00 = *(B2 + 0 + 0*2 );
	            b10 = *(B2 + 1 + 0*2 );
	            c00 += a00 * b00;
	            c01 += a00 * b10;
	            c10 += a10 * b00;
	            c11 += a10 * b10;
	            c20 += a20 * b00;
	            c21 += a20 * b10;
	            c30 += a30 * b00;
	            c31 += a30 * b10;
	            A2+=4;
	            B2+=2;
	        }
	        *(C+0+0*ldc) += alpha*c00;
	        *(C+0+1*ldc) += alpha*c01;
	        *(C+1+0*ldc) += alpha*c10;
	        *(C+1+1*ldc) += alpha*c11;
	        *(C+2+0*ldc) += alpha*c20;
	        *(C+2+1*ldc) += alpha*c21;
	        *(C+3+0*ldc) += alpha*c30;
	        *(C+3+1*ldc) += alpha*c31;
	        B2 = B2 - 2*K1;//N*K1
	        C+=4;
	      }

	    }
	    if( m & 2 ){

	        c00=0e0;c01=0e0;c02=0e0;c03=0e0;
	        c10=0e0;c11=0e0;c12=0e0;c13=0e0;
	        c20=0e0;c21=0e0;c22=0e0;c23=0e0;
	        c30=0e0;c31=0e0;c32=0e0;c33=0e0;
	        size_t k = K1;
	        if( k >> 3 ){
	          size_t k8 = ( k >> 3 );
	          while( k8-- ){
	            a00 = *(A2 + 0 + 0*2 ); a01 = *(A2 +  0 + 1*2 ); a02 = *(A2 + 0 + 2*2 ); a03 = *(A2 + 0 + 3*2 );
	            a10 = *(A2 + 1 + 0*2 ); a11 = *(A2 +  1 + 1*2 ); a12 = *(A2 + 1 + 2*2 ); a13 = *(A2 + 1 + 3*2 );
	            b00 = *(B2 + 0 + 0*2 ); b01 = *(B2 +  0 + 1*2 ); b02 = *(B2 + 0 + 2*2 ); b03 = *(B2 + 0 + 3*2 );
	            b10 = *(B2 + 1 + 0*2 ); b11 = *(B2 +  1 + 1*2 ); b12 = *(B2 + 1 + 2*2 ); b13 = *(B2 + 1 + 3*2 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            a00 = *(A2 + 0 + 4*2 ); a01 = *(A2 +  0 + 5*2 ); a02 = *(A2 + 0 + 6*2 ); a03 = *(A2 + 0 + 7*2 );
	            a10 = *(A2 + 1 + 4*2 ); a11 = *(A2 +  1 + 5*2 ); a12 = *(A2 + 1 + 6*2 ); a13 = *(A2 + 1 + 7*2 );
	            b00 = *(B2 + 0 + 4*2 ); b01 = *(B2 +  0 + 5*2 ); b02 = *(B2 + 0 + 6*2 ); b03 = *(B2 + 0 + 7*2 );
	            b10 = *(B2 + 1 + 4*2 ); b11 = *(B2 +  1 + 5*2 ); b12 = *(B2 + 1 + 6*2 ); b13 = *(B2 + 1 + 7*2 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            A2+=16;
	            B2+=16;
	          }
	        }
	        if( k & 4 ){
	            a00 = *(A2 + 0 + 0*2 ); a01 = *(A2 +  0 + 1*2 ); a02 = *(A2 + 0 + 2*2 ); a03 = *(A2 + 0 + 3*2 );
	            a10 = *(A2 + 1 + 0*2 ); a11 = *(A2 +  1 + 1*2 ); a12 = *(A2 + 1 + 2*2 ); a13 = *(A2 + 1 + 3*2 );
	            b00 = *(B2 + 0 + 0*2 ); b01 = *(B2 +  0 + 1*2 ); b02 = *(B2 + 0 + 2*2 ); b03 = *(B2 + 0 + 3*2 );
	            b10 = *(B2 + 1 + 0*2 ); b11 = *(B2 +  1 + 1*2 ); b12 = *(B2 + 1 + 2*2 ); b13 = *(B2 + 1 + 3*2 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c11 += a10 * b10; c11 += a11 * b11; c11 += a12 * b12; c11 += a13 * b13; 
	            A2+=8;
	            B2+=8;
	        }
	        if( k & 2 ){
	            a00 = *(A2 + 0 + 0*2 ); a01 = *(A2 +  0 + 1*2 );
	            a10 = *(A2 + 1 + 0*2 ); a11 = *(A2 +  1 + 1*2 );
	            b00 = *(B2 + 0 + 0*2 ); b01 = *(B2 +  0 + 1*2 );
	            b10 = *(B2 + 1 + 0*2 ); b11 = *(B2 +  1 + 1*2 );
	            c00 += a00 * b00; c00 += a01 * b01;
	            c01 += a00 * b10; c01 += a01 * b11;
	            c10 += a10 * b00; c10 += a11 * b01;
	            c11 += a10 * b10; c11 += a11 * b11;
	            A2+=4;
	            B2+=4;
	        }
	        if( k & 1 ){
	            a00 = *(A2 + 0 + 0*2 );
	            a10 = *(A2 + 1 + 0*2 );
	            b00 = *(B2 + 0 + 0*2 );
	            b10 = *(B2 + 1 + 0*2 );
	            c00 += a00 * b00;
	            c01 += a00 * b10;
	            c10 += a10 * b00;
	            c11 += a10 * b10;
	            A2+=2;
	            B2+=2;
	        }
	        *(C+0+0*ldc) += alpha*c00;
	        *(C+0+1*ldc) += alpha*c01;
	        *(C+1+0*ldc) += alpha*c10;
	        *(C+1+1*ldc) += alpha*c11;
	        B2 = B2 - 2*K1;//N*K1
	        C+=2;

	    }
	    if( m & 1 ){

	        c00=0e0;c01=0e0;c02=0e0;c03=0e0;
	        c10=0e0;c11=0e0;c12=0e0;c13=0e0;
	        c20=0e0;c21=0e0;c22=0e0;c23=0e0;
	        c30=0e0;c31=0e0;c32=0e0;c33=0e0;
	        size_t k = K1;
	        if( k >> 3 ){
	          size_t k8 = ( k >> 3 );
	          while( k8-- ){
	            a00 = *(A2 + 0 + 0*1 ); a01 = *(A2 +  0 + 1*1 ); a02 = *(A2 + 0 + 2*1 ); a03 = *(A2 + 0 + 3*1 );
	            b00 = *(B2 + 0 + 0*2 ); b01 = *(B2 +  0 + 1*2 ); b02 = *(B2 + 0 + 2*2 ); b03 = *(B2 + 0 + 3*2 );
	            b10 = *(B2 + 1 + 0*2 ); b11 = *(B2 +  1 + 1*2 ); b12 = *(B2 + 1 + 2*2 ); b13 = *(B2 + 1 + 3*2 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            a00 = *(A2 + 0 + 4*1 ); a01 = *(A2 +  0 + 5*1 ); a02 = *(A2 + 0 + 6*1 ); a03 = *(A2 + 0 + 7*1 );
	            b00 = *(B2 + 0 + 4*2 ); b01 = *(B2 +  0 + 5*2 ); b02 = *(B2 + 0 + 6*2 ); b03 = *(B2 + 0 + 7*2 );
	            b10 = *(B2 + 1 + 4*2 ); b11 = *(B2 +  1 + 5*2 ); b12 = *(B2 + 1 + 6*2 ); b13 = *(B2 + 1 + 7*2 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            A2+=8;
	            B2+=16;
	          }
	        }
	        if( k & 4 ){
	            a00 = *(A2 + 0 + 0*1 ); a01 = *(A2 +  0 + 1*1 ); a02 = *(A2 + 0 + 2*1 ); a03 = *(A2 + 0 + 3*1 );
	            b00 = *(B2 + 0 + 0*2 ); b01 = *(B2 +  0 + 1*2 ); b02 = *(B2 + 0 + 2*2 ); b03 = *(B2 + 0 + 3*2 );
	            b10 = *(B2 + 1 + 0*2 ); b11 = *(B2 +  1 + 1*2 ); b12 = *(B2 + 1 + 2*2 ); b13 = *(B2 + 1 + 3*2 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c01 += a00 * b10; c01 += a01 * b11; c01 += a02 * b12; c01 += a03 * b13; 
	            A2+=4;
	            B2+=8;
	        }
	        if( k & 2 ){
	            a00 = *(A2 + 0 + 0*1 ); a01 = *(A2 +  0 + 1*1 );
	            b00 = *(B2 + 0 + 0*2 ); b01 = *(B2 +  0 + 1*2 );
	            b10 = *(B2 + 1 + 0*2 ); b11 = *(B2 +  1 + 1*2 );
	            c00 += a00 * b00; c00 += a01 * b01;
	            c01 += a00 * b10; c01 += a01 * b11;
	            A2+=2;
	            B2+=4;
	        }
	        if( k & 1 ){
	            a00 = *(A2 + 0 + 0*1 );
	            b00 = *(B2 + 0 + 0*2 );
	            b10 = *(B2 + 1 + 0*2 );
	            c00 += a00 * b00;
	            c01 += a00 * b10;
	            A2+=1;
	            B2+=2;
	        }
	        *(C+0+0*ldc) += alpha*c00;
	        *(C+0+1*ldc) += alpha*c01;
	        B2 = B2 - 2*K1;//N*K1
	        C+=1;

	    }
	    A2 = A2 - M1*K1;
	    B2 = B2 + 2*K1;
	    C  = C - M1 + 2*ldc;

	}
	if( n & 1 ){

	    size_t m = M1;
	    if( m >> 2 ){
	      size_t m4 = ( m >> 2 );
	      while( m4-- ){

	        c00=0e0;c01=0e0;c02=0e0;c03=0e0;
	        c10=0e0;c11=0e0;c12=0e0;c13=0e0;
	        c20=0e0;c21=0e0;c22=0e0;c23=0e0;
	        c30=0e0;c31=0e0;c32=0e0;c33=0e0;
	        size_t k = K1;
	        if( k >> 3 ){
	          size_t k8 = ( k >> 3 );
	          while( k8-- ){
	            a00 = *(A2 + 0 + 0*4 ); a01 = *(A2 +  0 + 1*4 ); a02 = *(A2 + 0 + 2*4 ); a03 = *(A2 + 0 + 3*4 );
	            a10 = *(A2 + 1 + 0*4 ); a11 = *(A2 +  1 + 1*4 ); a12 = *(A2 + 1 + 2*4 ); a13 = *(A2 + 1 + 3*4 );
	            a20 = *(A2 + 2 + 0*4 ); a21 = *(A2 +  2 + 1*4 ); a22 = *(A2 + 2 + 2*4 ); a23 = *(A2 + 2 + 3*4 );
	            a30 = *(A2 + 3 + 0*4 ); a31 = *(A2 +  3 + 1*4 ); a32 = *(A2 + 3 + 2*4 ); a33 = *(A2 + 3 + 3*4 );
	            b00 = *(B2 + 0 + 0*1 ); b01 = *(B2 +  0 + 1*1 ); b02 = *(B2 + 0 + 2*1 ); b03 = *(B2 + 0 + 3*1 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c20 += a20 * b00; c20 += a21 * b01; c20 += a22 * b02; c20 += a23 * b03; 
	            c30 += a30 * b00; c30 += a31 * b01; c30 += a32 * b02; c30 += a33 * b03; 
	            a00 = *(A2 + 0 + 4*4 ); a01 = *(A2 +  0 + 5*4 ); a02 = *(A2 + 0 + 6*4 ); a03 = *(A2 + 0 + 7*4 );
	            a10 = *(A2 + 1 + 4*4 ); a11 = *(A2 +  1 + 5*4 ); a12 = *(A2 + 1 + 6*4 ); a13 = *(A2 + 1 + 7*4 );
	            a20 = *(A2 + 2 + 4*4 ); a21 = *(A2 +  2 + 5*4 ); a22 = *(A2 + 2 + 6*4 ); a23 = *(A2 + 2 + 7*4 );
	            a30 = *(A2 + 3 + 4*4 ); a31 = *(A2 +  3 + 5*4 ); a32 = *(A2 + 3 + 6*4 ); a33 = *(A2 + 3 + 7*4 );
	            b00 = *(B2 + 0 + 4*1 ); b01 = *(B2 +  0 + 5*1 ); b02 = *(B2 + 0 + 6*1 ); b03 = *(B2 + 0 + 7*1 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c20 += a20 * b00; c20 += a21 * b01; c20 += a22 * b02; c20 += a23 * b03; 
	            c30 += a30 * b00; c30 += a31 * b01; c30 += a32 * b02; c30 += a33 * b03; 
	            A2+=32;
	            B2+=8;
	          }
	        }
	        if( k & 4 ){
	            a00 = *(A2 + 0 + 0*4 ); a01 = *(A2 +  0 + 1*4 ); a02 = *(A2 + 0 + 2*4 ); a03 = *(A2 + 0 + 3*4 );
	            a10 = *(A2 + 1 + 0*4 ); a11 = *(A2 +  1 + 1*4 ); a12 = *(A2 + 1 + 2*4 ); a13 = *(A2 + 1 + 3*4 );
	            a20 = *(A2 + 2 + 0*4 ); a21 = *(A2 +  2 + 1*4 ); a22 = *(A2 + 2 + 2*4 ); a23 = *(A2 + 2 + 3*4 );
	            a30 = *(A2 + 3 + 0*4 ); a31 = *(A2 +  3 + 1*4 ); a32 = *(A2 + 3 + 2*4 ); a33 = *(A2 + 3 + 3*4 );
	            b00 = *(B2 + 0 + 0*1 ); b01 = *(B2 +  0 + 1*1 ); b02 = *(B2 + 0 + 2*1 ); b03 = *(B2 + 0 + 3*1 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            c20 += a20 * b00; c20 += a21 * b01; c20 += a22 * b02; c20 += a23 * b03; 
	            c30 += a30 * b00; c30 += a31 * b01; c30 += a32 * b02; c30 += a33 * b03; 
	            A2+=16;
	            B2+=4;
	        }
	        if( k & 2 ){
	            a00 = *(A2 + 0 + 0*4 ); a01 = *(A2 +  0 + 1*4 );
	            a10 = *(A2 + 1 + 0*4 ); a11 = *(A2 +  1 + 1*4 );
	            a20 = *(A2 + 2 + 0*4 ); a21 = *(A2 +  2 + 1*4 );
	            a30 = *(A2 + 3 + 0*4 ); a31 = *(A2 +  3 + 1*4 );
	            b00 = *(B2 + 0 + 0*1 ); b01 = *(B2 +  0 + 1*1 );
	            c00 += a00 * b00; c00 += a01 * b01;
	            c10 += a10 * b00; c10 += a11 * b01;
	            c20 += a20 * b00; c20 += a21 * b01;
	            c30 += a30 * b00; c30 += a31 * b01;
	            A2+=8;
	            B2+=2;
	        }
	        if( k & 1 ){
	            a00 = *(A2 + 0 + 0*4 );
	            a10 = *(A2 + 1 + 0*4 );
	            a20 = *(A2 + 2 + 0*4 );
	            a30 = *(A2 + 3 + 0*4 );
	            b00 = *(B2 + 0 + 0*1 );
	            c00 += a00 * b00;
	            c10 += a10 * b00;
	            c20 += a20 * b00;
	            c30 += a30 * b00;
	            A2+=4;
	            B2+=1;
	        }
	        *(C+0+0*ldc) += alpha*c00;
	        *(C+1+0*ldc) += alpha*c10;
	        *(C+2+0*ldc) += alpha*c20;
	        *(C+3+0*ldc) += alpha*c30;
	        B2 = B2 - 1*K1;//N*K1
	        C+=4;
	      }

	    }
	    if( m & 2 ){

	        c00=0e0;c01=0e0;c02=0e0;c03=0e0;
	        c10=0e0;c11=0e0;c12=0e0;c13=0e0;
	        c20=0e0;c21=0e0;c22=0e0;c23=0e0;
	        c30=0e0;c31=0e0;c32=0e0;c33=0e0;
	        size_t k = K1;
	        if( k >> 3 ){
	          size_t k8 = ( k >> 3 );
	          while( k8-- ){
	            a00 = *(A2 + 0 + 0*2 ); a01 = *(A2 +  0 + 1*2 ); a02 = *(A2 + 0 + 2*2 ); a03 = *(A2 + 0 + 3*2 );
	            a10 = *(A2 + 1 + 0*2 ); a11 = *(A2 +  1 + 1*2 ); a12 = *(A2 + 1 + 2*2 ); a13 = *(A2 + 1 + 3*2 );
	            b00 = *(B2 + 0 + 0*1 ); b01 = *(B2 +  0 + 1*1 ); b02 = *(B2 + 0 + 2*1 ); b03 = *(B2 + 0 + 3*1 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            a00 = *(A2 + 0 + 4*2 ); a01 = *(A2 +  0 + 5*2 ); a02 = *(A2 + 0 + 6*2 ); a03 = *(A2 + 0 + 7*2 );
	            a10 = *(A2 + 1 + 4*2 ); a11 = *(A2 +  1 + 5*2 ); a12 = *(A2 + 1 + 6*2 ); a13 = *(A2 + 1 + 7*2 );
	            b00 = *(B2 + 0 + 4*1 ); b01 = *(B2 +  0 + 5*1 ); b02 = *(B2 + 0 + 6*1 ); b03 = *(B2 + 0 + 7*1 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            A2+=16;
	            B2+=8;
	          }
	        }
	        if( k & 4 ){
	            a00 = *(A2 + 0 + 0*2 ); a01 = *(A2 +  0 + 1*2 ); a02 = *(A2 + 0 + 2*2 ); a03 = *(A2 + 0 + 3*2 );
	            a10 = *(A2 + 1 + 0*2 ); a11 = *(A2 +  1 + 1*2 ); a12 = *(A2 + 1 + 2*2 ); a13 = *(A2 + 1 + 3*2 );
	            b00 = *(B2 + 0 + 0*1 ); b01 = *(B2 +  0 + 1*1 ); b02 = *(B2 + 0 + 2*1 ); b03 = *(B2 + 0 + 3*1 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            c10 += a10 * b00; c10 += a11 * b01; c10 += a12 * b02; c10 += a13 * b03; 
	            A2+=8;
	            B2+=4;
	        }
	        if( k & 2 ){
	            a00 = *(A2 + 0 + 0*2 ); a01 = *(A2 +  0 + 1*2 );
	            a10 = *(A2 + 1 + 0*2 ); a11 = *(A2 +  1 + 1*2 );
	            b00 = *(B2 + 0 + 0*1 ); b01 = *(B2 +  0 + 1*1 );
	            c00 += a00 * b00; c00 += a01 * b01;
	            c10 += a10 * b00; c10 += a11 * b01;
	            A2+=4;
	            B2+=2;
	        }
	        if( k & 1 ){
	            a00 = *(A2 + 0 + 0*2 );
	            a10 = *(A2 + 1 + 0*2 );
	            b00 = *(B2 + 0 + 0*1 );
	            c00 += a00 * b00;
	            c10 += a10 * b00;
	            A2+=2;
	            B2+=1;
	        }
	        *(C+0+0*ldc) += alpha*c00;
	        *(C+1+0*ldc) += alpha*c10;
	        B2 = B2 - 1*K1;//N*K1
	        C+=2;

	    }
	    if( m & 1 ){

	        c00=0e0;c01=0e0;c02=0e0;c03=0e0;
	        c10=0e0;c11=0e0;c12=0e0;c13=0e0;
	        c20=0e0;c21=0e0;c22=0e0;c23=0e0;
	        c30=0e0;c31=0e0;c32=0e0;c33=0e0;
	        size_t k = K1;
	        if( k >> 3 ){
	          size_t k8 = ( k >> 3 );
	          while( k8-- ){
	            a00 = *(A2 + 0 + 0*1 ); a01 = *(A2 +  0 + 1*1 ); a02 = *(A2 + 0 + 2*1 ); a03 = *(A2 + 0 + 3*1 );
	            b00 = *(B2 + 0 + 0*1 ); b01 = *(B2 +  0 + 1*1 ); b02 = *(B2 + 0 + 2*1 ); b03 = *(B2 + 0 + 3*1 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            a00 = *(A2 + 0 + 4*1 ); a01 = *(A2 +  0 + 5*1 ); a02 = *(A2 + 0 + 6*1 ); a03 = *(A2 + 0 + 7*1 );
	            b00 = *(B2 + 0 + 4*1 ); b01 = *(B2 +  0 + 5*1 ); b02 = *(B2 + 0 + 6*1 ); b03 = *(B2 + 0 + 7*1 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            A2+=8;
	            B2+=8;
	          }
	        }
	        if( k & 4 ){
	            a00 = *(A2 + 0 + 0*1 ); a01 = *(A2 +  0 + 1*1 ); a02 = *(A2 + 0 + 2*1 ); a03 = *(A2 + 0 + 3*1 );
	            b00 = *(B2 + 0 + 0*1 ); b01 = *(B2 +  0 + 1*1 ); b02 = *(B2 + 0 + 2*1 ); b03 = *(B2 + 0 + 3*1 );
	            c00 += a00 * b00; c00 += a01 * b01; c00 += a02 * b02; c00 += a03 * b03; 
	            A2+=4;
	            B2+=4;
	        }
	        if( k & 2 ){
	            a00 = *(A2 + 0 + 0*1 ); a01 = *(A2 +  0 + 1*1 );
	            b00 = *(B2 + 0 + 0*1 ); b01 = *(B2 +  0 + 1*1 );
	            c00 += a00 * b00; c00 += a01 * b01;
	            A2+=2;
	            B2+=2;
	        }
	        if( k & 1 ){
	            a00 = *(A2 + 0 + 0*1 );
	            b00 = *(B2 + 0 + 0*1 );
	            c00 += a00 * b00;
	            A2+=1;
	            B2+=1;
	        }
	        *(C+0+0*ldc) += alpha*c00;
	        B2 = B2 - 1*K1;//N*K1
	        C+=1;

	    }
	    A2 = A2 - M1*K1;
	    B2 = B2 + 1*K1;
	    C  = C - M1 + 1*ldc;
	}

	A2 = A2 + M1*K1;
	B2 = B2 - K1*N1;
	C  = C - ldc*N1 + M1;
	// ---- Kernel

}

